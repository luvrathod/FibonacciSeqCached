I tried to get rid of the 'integer' overflow, by replacing with unsigned long long but the code doesn't seem to be working at all... 
